<header>
  <%= render partial: "layouts/menu" %>
</header>

<p id="notice"><%= notice %></p>

<h1>Продукция</h1>

<table class="table table-striped">
  <thead>
  <tr>
    <th>Группа</th>
    <th>Наименование</th>
    <th>Описание</th>
    <th>Упаковка</th>
    <th></th>
    <th>Цена</th>
    <th colspan="3"></th>
  </tr>
  </thead>

  <tbody>
  <%cache @products do%>
    <% @products.each do |product| %>
        <%cache product do%>
        <tr class="">
          <td><%= product['parents_name']%></td>
          <td><%= product['title'] %></td>
          <td><%= product['description'] %></td>
          <td></td>
          <td><%= image_tag(product['image_url'], class:"img-thumbnail",size: "200x200") %></td>
          <td><%= sprintf("%0.02f грн.", Product.get_price(product['id'])) %></td>
          <td> <%= button_to 'В корзину', line_items_path({:id => product['id'], :pack_id => product['pack_id']}),remote: true%></td>
        </tr>
        <%packs = Product.get_packs_product(product['id'])%>
        <%packs.each do |pack|%>
        <tr class="">
          <td></td>
          <td></td>
          <td></td>
          <td><%= pack['pack_name'] %></td>
          <td></td>
          <td><%= sprintf("%0.02f грн.", Product.get_price(product['id'])) %></td>
          <td> <%= button_to 'В корзину', line_items_path({:id => product['id'], :pack_id => product['pack_id']}),remote: true%></td>
        </tr>
        <%end%>
      <%end%>
    <% end %>
  <%end%>
  </tbody>
</table>
